# NodePulse 海外节点网络稳定性检测工具 PRD

## 一、产品概述

### 1.1 产品定位

NodePulse 是一款专为海外节点设计的网络稳定性检测工具,采用 Pulse Beacon(信标组件)与 Pulse(核心服务)协同工作的架构,聚焦跨境网络场景。Pulse Beacon 负责精准采集时延、丢包率、抖动等核心指标,具备独立部署能力;Pulse 完成数据分析、展示、告警等功能。两者互补成为完整系统,帮助运维团队实时掌握海外节点网络性能状态,快速定位问题根源,为网络优化提供数据支撑,保障海外业务稳定运行。

### 1.2 核心价值

- **精准感知**: 全面覆盖跨境网络核心性能指标,适配海外 ICMP 禁 ping 等特殊环境
- **实时告警**: 分级预警机制,提前发现网络异常,避免故障扩大
- **精准归因**: 快速区分问题类型,降低排查成本
- **数据驱动**: 通过历史统计与多维度对比,为网络优化提供可落地依据
- **可观测性集成**: 支持 Prometheus Metrics 接口,Beacon 可独立暴露指标供 Prometheus 抓取,Pulse 支持与 Prometheus-Stack 联动,适配多样化运维监控体系

### 1.3 品牌配套

- **Slogan**: NodePulse - Beat of Overseas Network Stability (节点脉搏 - 海外网络稳定性的心跳)
- **核心模块命名**:
  - Pulse Beacon: 信标组件,负责网络指标采集,部署在海外节点,持续发出网络探测信号
  - Pulse: 核心服务,包含数据分析、告警服务、可视化仪表盘、配置管理功能,是整个系统的心脏

## 二、目标用户与使用场景

### 2.1 目标用户

- **海外运维工程师**: 负责海外节点日常监控、异常排查、网络优化
- **网络优化专员**: 基于工具数据制定跨境链路优化方案
- **运维管理人员**: 掌握海外节点整体性能态势,评估网络质量

### 2.2 核心使用场景

- **日常巡检**: 定时监测海外各地区节点的网络连通性与稳定性,生成健康报告
- **异常排查**: 节点出现业务卡顿/断连时,通过工具定位问题根源(跨境链路/节点本地/运营商)
- **优化评估**: 对比不同地区/运营商节点性能,评估网络优化方案效果
- **应急响应**: 节点突发网络故障时,接收实时告警并快速开展故障处置

## 三、核心目标

1. **指标全覆盖**: 基于 Pulse Beacon 与 Pulse 协同工作的架构,精准采集时延、丢包率、抖动等核心网络指标,适配海外 ICMP 禁 ping 等特殊跨境环境
2. **实时性保障**: Pulse Beacon 采集与 Pulse 分析协同,秒级呈现节点实时性能状态,异常告警延迟 ≤30 秒
3. **问题易定位**: 通过主动+被动双探测结合的分析能力,快速区分节点本地/跨境链路/运营商问题,缩短排查时间
4. **运维轻量化**: 支持快速部署与批量节点管理,降低海外运维成本

## 四、核心功能需求(Pulse Beacon + Pulse 协同架构)

### 4.1 Pulse Beacon(信标组件)

#### 4.1.1 基础能力

- **跨平台适配**: 支持 Linux(CentOS、Ubuntu)、Windows Server 等海外常用操作系统
- **轻量化部署**: CPU 占用 ≤5%,内存占用 ≤100M,无额外依赖,支持一键安装/卸载
- **数据加密**: 采集数据采用 AES 加密传输,保障跨境数据传输安全
- **独立运行能力**: 支持不依赖 Pulse 独立运行,核心指标可通过 Prometheus Metrics 接口暴露

#### 4.1.2 指标采集

- **时延类**: 采集往返 RTT、单程时延、网络抖动、时延方差
- **丢包类**: 采集 ICMP/TCP/UDP 丢包率、分片丢包率、链路丢包节点
- **辅助类**: 采集路由跳数、上行/下行带宽、TCP 建联耗时、DNS 解析时延
- **业务关联**: 支持被动抓包分析实际业务流量的性能指标,避免探测与业务脱节

#### 4.1.3 配置管理

- **配置格式**: Beacon 与 Pulse 遵循统一的配置规范,采用 YAML 格式(支持 JSON 作为备选),配置键名使用小驼峰（camelCase）,时间参数统一使用秒作为单位,百分比参数使用 0-100 范围的浮点数

- **配置热更新**: Beacon 配置变更后平滑重载,不影响正在执行的探测任务,已启动的任务按原配置完成,新任务按新配置执行

- **配置优先级**: 独立模式仅使用本地配置,注册模式下 Pulse 下发配置优先级高于本地配置

#### 4.1.4 探测方式

Beacon 支持多种探测方式,通过配置驱动执行:

**Ping 探测**
- ICMP Ping: 发送 ICMP Echo Request 测量网络连通性和往返时延,支持配置数据包大小、超时时间、探测次数
- TCP Ping: 使用 TCP SYN 包探测目标端口连通性,适用于 ICMP 禁用的网络环境(默认优先使用)
- UDP Ping: 使用 UDP 包探测网络连通性,支持自定义端口

**MTR 探测**
- 集成 MTR 工具,结合 Ping 和 Traceroute 功能,逐跳分析网络路由路径、每跳时延、丢包率
- 支持配置最大跳数、探测间隔、协议类型

**Traceroute 探测**
- 追踪从 Beacon 到目标节点的完整网络路径,识别路由跳数、每一跳的 IP 地址和时延
- 支持 ICMP/TCP/UDP 三种协议追踪,适配不同网络环境

**Iperf3 探测**
- 测量网络带宽性能,支持 TCP 和 UDP 协议
- 可获取上下行带宽、抖动、丢包率等指标
- 支持配置测试时长、并发连接数、窗口大小等参数

**业务流量抓包监控**
- **触发逻辑**: 接收 Pulse 下发的需监控业务端口列表,仅捕获指定端口的进出流量,不抓取全量流量(减少资源占用)
- **抓包实现**: 集成轻量抓包库(如 Linux 下的 libpcap、Windows 下的 WinPcap),以"低功耗模式"运行,CPU 占用 ≤2%,避免影响节点正常业务运行
- **指标解析**: 从捕获的 TCP/UDP 数据包中提取关键性能指标:
  - **TCP 层面**: 三次握手耗时(反映连接建立速度)、重传率(数据包丢失后重新发送的比例,直接关联业务卡顿)、滑动窗口大小(影响数据传输效率)
  - **业务层面**: 单请求往返耗时(从客户端发请求到接收响应的总时间)、上行/下行吞吐量(单位时间内传输的业务数据量)

**探测参数配置**
- **数据包大小**: 64/128/512 字节可选
- **探测超时**: 1-30 秒可配
- **探测周期**: 1/5/10/30 分钟可选,默认 5 分钟

#### 4.1.5 探测策略执行

Beacon 支持两种运行模式:独立模式和注册模式,两种模式使用统一的探测规则规范。

##### 4.1.5.1 独立模式

Beacon 未注册到 Pulse 时,通过本地配置驱动探测任务,适用于轻量化运维场景或与 Prometheus 直接集成的场景。

- **探测规则定义**: 支持定义探测周期、探测目标、探测协议、数据包大小、超时时间、并发控制等参数
- **被动监控**: 支持定义需要监控的业务端口列表
- **配置热更新**: 支持配置变更后自动重载,无需重启 Beacon

##### 4.1.5.2 注册模式

Beacon 注册到 Pulse 后,由 Pulse 动态下发探测配置,实现集中化的探测管理。

- **配置优先级**: Pulse 下发的配置优先级高于本地配置
- **配置下发**: 通过心跳同步和主动推送机制接收 Pulse 下发的配置
- **配置容错**: 与 Pulse 断连时保持最后收到的配置继续运行,连接恢复后同步最新配置

#### 4.1.6 自愈执行

Beacon 支持执行 Pulse 下发的自愈规则,实现简单故障的自动修复。

- **自愈规则接收**: 通过配置下发机制接收 Pulse 配置的自愈规则,规则包含触发条件、执行动作、执行前确认等参数
- **自愈动作执行**: 支持执行以下自愈动作:
  - **服务重启**: 当检测到网络服务卡死时,自动重启服务进程
  - **端口重新绑定**: 当检测到端口监听异常时,重新绑定端口
  - **网络接口重置**: 当检测到网络接口异常时,重置网络接口
- **自愈前确认**: 执行自愈动作前进行前置检查(如 SSH 连通性检查),避免误操作
- **自愈执行限制**: 限制同一规则在指定时间内的执行次数,防止自愈失败导致死循环
- **自愈日志上报**: 记录自愈操作过程、结果,并上报至 Pulse,便于追溯和审计
- **自愈失败告警**: 自愈失败时立即上报告警,通知运维人员介入处理

### 4.2 Pulse(核心服务)

**说明**: 整合分析、展示、告警等核心功能,接收 Pulse Beacon 上传的探测数据并完成后续处理。Pulse Beacon 与 Pulse 互补成为完整系统,Beacon 可独立部署运行,也可注册到 Pulse 实现集中化监控管理。

#### 4.2.1 探测管理与指标分析

##### 4.2.1.1 实时分析

- **秒级计算**: 实时汇总各节点采集指标,生成单节点/批量节点的实时性能数据

- **健康状态判定**: 按指标阈值划分红(异常)、黄(预警)、绿(正常)三色状态,默认规则:
  - 🔴 **红色**: 丢包率>30%、RTT>1000ms、节点断连、业务端口不可达
  - 🟡 **黄色**: 丢包率 5%-30%、RTT 500-1000ms、抖动>100ms
  - 🟢 **绿色**: 丢包率≤5%、RTT≤500ms、抖动≤100ms

##### 4.2.1.2 历史分析

- **数据聚合**: 基于本地缓存的短期历史数据(7 天内),按小时/天聚合数据,计算指标均值、峰值、中位数、波动率
- **性能基线**: 基于 7 天正常运行数据生成各节点的性能基线,指标偏离基线±30%即触发预警
- **多维度对比**: 支持地区排行、运营商排行、同节点不同时段对比、不同链路对比
- **异常归因**: 自动区分问题类型:节点本地故障(如服务异常)、跨境链路问题(如国际出口拥堵)、运营商路由绕路、机房网络故障

##### 4.2.1.3 探测规则管理

- **规则创建**: 支持为单个节点或分组创建探测规则,包含探测频率、探测协议、数据包大小、并发控制、超时时间等参数
- **模板管理**: 支持创建配置模板,快速应用到新节点或分组,模板包含探测规则参数组合(如"高频探测模板""ICMP 禁用环境模板"),避免重复配置
- **配置预览**: 配置下发前提供预览功能,展示即将下发的配置内容,确认配置正确性后再执行下发
- **分组批量下发**: 支持按"节点地区/运营商/业务类型"创建分组,实现分组批量下发配置,一次操作影响多个节点

#### 4.2.2 分级告警与轻自愈

##### 4.2.2.1 告警触发规则

- **阈值告警**: 基于实时指标计算结果与告警阈值对比,判定是否触发告警,支持时延、丢包率、抖动、带宽利用率等多种指标
- **趋势预警**: 持续监测指标变化趋势,当指标连续恶化(如时延持续上涨、丢包率持续上升)时提前触发预警,避免故障扩散
- **告警抑制**: 同一节点同一类型异常,在设定时间窗口内(默认 5 分钟)仅推送一次告警,避免告警风暴干扰运维判断

##### 4.2.2.2 告警分级

基于告警严重程度划分为三级,对应不同的响应要求:

| 级别 | 场景 | 响应要求 |
|------|------|----------|
| **严重(P0)** | 节点断连、丢包率>30%、业务核心端口不可达 | 立即处置 |
| **一般(P1)** | 时延/抖动超阈值、带宽利用率≥90% | 1 小时内关注 |
| **提醒(P2)** | 指标偏离基线、路由轻微绕路 | 定期跟踪 |

##### 4.2.2.3 告警渠道与推送

- **推送机制**: 支持通过多种渠道推送告警,包含邮件、钉钉/企业微信、Slack、短信等,可按告警级别差异化配置推送渠道组合
- **推送内容**: 告警消息包含异常节点名称、IP、地区、异常指标(当前值/阈值)、问题类型、发生时间、处理建议等信息,便于运维人员快速定位与处置
- **告警记录**: 留存所有告警记录,支持按节点、时间、级别筛选查询,记录告警处理状态(未处理/处理中/已解决),便于追踪告警处置情况

##### 4.2.2.4 告警规则配置

- **告警阈值配置**: 支持自定义各指标告警阈值(丢包率、时延、抖动、带宽利用率等),用户可覆盖默认规则
- **趋势预警配置**: 支持配置指标持续恶化规则(如时延每 5 分钟上涨≥100ms、丢包率每 10 分钟上升≥5%),提前触发预警
- **告警渠道配置**: 支持按告警级别配置推送渠道(如 P0 级推送短信+邮件+Slack,P1 级推送邮件+企业微信),支持邮件、钉钉/企业微信、Slack、短信多渠道
- **差异化规则**: 支持按节点/分组配置差异化告警规则,满足不同业务场景需求(如核心节点设置更严格的阈值)
- **告警规则模板**: 支持创建告警规则模板,快速应用到新节点或分组,避免重复配置
- **规则导入导出**: 支持告警规则的导入/导出(yaml/json 格式),便于在不同环境间迁移或备份规则

##### 4.2.2.5 告警接入配置

- **Alertmanager 集成**: 支持将 Pulse 的异常判定结果推送至 Prometheus Alertmanager,与现有告警体系联动,实现告警统一管理
- **接入配置**:
  - **URL 配置**: 支持配置 Alertmanager API 端点 URL(如 `http://alertmanager:9093/api/v1/alerts`)
  - **认证配置**: 支持 Basic Auth 和 Bearer Token 认证方式,保障告警推送安全
  - **标签映射**: 支持配置告警标签映射规则,将 Pulse 的节点信息(IP、地区、运营商等)映射为 Prometheus 标签(label),便于在 Alertmanager 中进行告警分组、路由和抑制
  - **注解映射**: 支持配置告警注解(annotation)模板,自定义告警内容格式(如包含处理建议、相关链接等)
  - **告警去重**: 配置去重策略(如按节点+告警类型去重),避免向 Alertmanager 重复推送相同告警
- **告警级别映射**: 支持将 Pulse 的告警级别(P0/P1/P2)映射为 Prometheus Alertmanager 的 severity 标签(如 critical/warning/info),便于在 Grafana 等可视化工具中区分告警严重程度
- **接入状态监控**: 实时展示告警推送成功率、失败次数、平均推送延迟等指标,失败时提供错误日志便于排查

##### 4.2.2.6 轻自愈能力

Pulse 支持配置和管理自愈规则,并下发给 Beacon 执行,实现简单故障的自动修复。

- **自愈规则配置**: 支持配置自愈规则,包含以下参数:
  - **触发条件**: 定义触发自愈的条件,如 P0 告警且持续时长 >5 分钟
  - **执行动作**: 定义自愈动作类型,如重启服务、重新绑定端口、重置网络接口
  - **执行前确认**: 配置自愈前是否进行前置检查(如 SSH 连通性检查)
  - **执行次数限制**: 限制同一规则在指定时间内的执行次数,防止自愈失败导致死循环
- **自愈规则下发**: 通过配置下发机制将自愈规则下发至 Beacon,Beacon 根据规则执行自愈动作
- **自愈执行状态监控**: 实时监控 Beacon 上报的自愈执行状态,展示规则触发次数、执行结果(成功/失败/跳过)、自愈失败次数
- **自愈日志管理**: 汇总并展示 Beacon 上报的自愈执行日志,包含执行时间、触发条件、执行动作、执行结果等详细信息,支持按节点、时间范围查询
- **自愈失败告警**: 当 Beacon 上报自愈失败时,立即触发告警通知运维人员介入处理

#### 4.2.3 可视化仪表盘与报表

##### 4.2.3.1 实时仪表盘

- **全局视图**: 展示所有海外节点的健康状态分布、异常节点 TOP5、核心指标均值
- **单节点详情**: 展示单个节点的实时时延/丢包率/抖动数据、路由链路拓扑图、丢包节点定位
- **筛选功能**: 支持按地区、运营商、业务类型、健康状态筛选节点

##### 4.2.3.2 报表功能

- **常规报表**: 生成日/周/月性能汇总报表,包含各节点指标统计、异常事件汇总、性能排行
- **定制报表**: 支持用户按筛选条件(如特定地区、特定业务节点)生成专属报表
- **导出功能**: 所有报表支持导出为 CSV/Excel/PDF 格式,支持定时推送报表至指定邮箱

#### 4.2.4 配置下发机制

- **心跳同步**: 在 Beacon 心跳响应中携带最新配置版本号,Beacon 检测到版本变化时主动拉取新配置,适用于长连接不可用或 Beacon 断线重连场景
- **主动推送**: 配置变更时通过长连接实时推送至在线 Beacon,优先保证配置实时生效,适用于在线节点
- **版本管理**: 每次配置变更生成新版本号,支持配置回滚至任意历史版本,支持查看历史配置变更记录(变更时间、变更人、变更内容)
- **配置验证**: 配置下发前 Pulse 端自动验证配置语法与参数合法性(如端口范围、IP 格式、探测协议有效性),避免下发错误配置导致 Beacon 异常。支持的配置类型包含探测规则、自愈规则、被动监控端口列表等
- **下发状态监控**: 实时跟踪配置下发进度与成功率,展示各节点的配置版本、下发时间、下发状态(成功/失败/待下发),失败时提供重试机制与失败原因说明

#### 4.2.5 节点管理

- **节点信息管理**: 支持增删改查节点信息,包含节点 IP、地区、运营商、业务类型、机房位置、负责人、Beacon 版本等
- **节点状态管理**: 支持启用/禁用节点探测,禁用节点不参与监控与告警,但保留节点信息便于后续重新启用
- **标签分组**: 支持为节点添加自定义标签(如"欧美区""电商业务""核心节点"),实现按标签快速筛选与批量操作
- **批量操作**: 支持批量导入节点(通过 CSV 文件)、批量启用/禁用、批量分配标签,提升运维效率

#### 4.2.6 权限管理

- **角色定义**: 预设角色包含管理员(所有权限)、操作员(执行探测与告警处理)、查看员(仅查看数据),支持自定义角色
- **权限控制**: 按用户角色限制功能访问,支持自定义权限策略(如限制某操作员只能管理特定地区的节点)
- **操作审计**: 记录所有配置变更操作,包含操作人、操作时间、变更内容、变更前后对比,便于追溯与合规审计

#### 4.2.7 海外场景专属适配

- **ICMP 禁 ping 适配**: 通过 Pulse 下发的探测协议配置,优先使用 TCP/UDP 探测,Beacon 自动适配海外机房 ICMP 禁用场景
- **多视角探测**: 通过 Pulse 配置定义多组探测目标(如"国内电信/联通/移动"与"海外本地运营商"),统一下发至 Beacon 执行,通过对比不同视角的探测结果精准区分跨境链路与节点本地问题
- **跨境传输优化**: 通过 Beacon 配置启用数据压缩与断点续传机制,避免跨境网络波动导致的数据丢失
- **本地化适配**: 支持多时区展示(自动适配节点所在时区)、中英双语切换,报表适配海外团队查看习惯
- **Prometheus 集成能力**:
  - **告警联动**: 支持将 Pulse 的异常判定结果推送至 Prometheus Alertmanager,与现有告警体系联动
  - **指标导出**: Pulse 自身运行指标(如数据处理延迟、告警推送成功率)支持通过 Prometheus Metrics 接口暴露,便于监控 Pulse 服务稳定性

## 五、非功能需求

### 5.1 性能要求

- **采集端性能**: Pulse Beacon 运行时 CPU 占用 ≤5%,内存占用 ≤100M
- **数据处理性能**: 支持 ≥1000 个海外节点同时探测,单节点指标计算延迟 ≤1 秒
- **告警延迟**: 异常发生后,告警推送延迟 ≤30 秒

### 5.2 兼容性要求

- **操作系统兼容**: 采集端支持 Linux(CentOS 9+、Ubuntu 24.04+)、Windows Server 2022+
- **浏览器兼容**: 可视化仪表盘支持 Chrome、Firefox、Edge 最新版本
- **运营商兼容**: 适配海外主流运营商(如 AT&T、Verizon、沃达丰、软银等)的网络环境
- **可观测性兼容**: 支持 Prometheus v2.0+版本抓取协议,适配 Prometheus-Stack(含 Prometheus、Alertmanager、Grafana)主流部署架构

### 5.3 安全性要求

- **数据安全**: 采集数据传输采用 AES 加密,存储数据采用加密存储,敏感信息(如节点 IP、负责人信息)脱敏展示
- **访问安全**: 支持账号密码+短信验证码登录,支持 IP 白名单限制访问,操作日志留存 6 个月
- **漏洞防护**: 定期进行安全扫描,修复高危漏洞,避免被恶意攻击

### 5.4 可扩展性要求

- **架构可扩展**: 核心服务端支持单体部署(初期简化运维),预留集群扩展能力(后续节点量增加时可横向扩容)
- **功能可扩展**: 预留 API 接口,支持后续对接海外云厂商(AWS/Azure/GCP)节点、业务监控平台
- **节点可扩展**: 支持节点数量横向扩展,新增节点可快速接入监控

### 5.5 易用性要求

- **部署简单**: 采集端支持一键安装脚本,服务端支持 Docker 容器化部署
- **操作直观**: 仪表盘布局清晰,核心指标一目了然,配置操作流程简单,减少运维学习成本
- **帮助文档**: 提供详细的使用手册、常见问题解答(FAQ),包含海外场景适配的特殊操作说明

## 六、数据需求

### 6.1 数据类型与存储周期

- **实时指标数据**: 留存 7 天,按分钟聚合
- **告警记录**: 留存 1 年
- **操作日志**: 留存 6 个月
- **节点配置信息**: 长期留存,随节点信息更新同步更新
- **Prometheus 暴露指标**: Beacon 独立运行时,指标仅在本地缓存(留存 1 小时),供 Prometheus 实时抓取;接入 Pulse 后,指标同步至 Pulse 本地缓存,遵循实时指标数据存储周期

### 6.2 数据存储方案

- **配置数据与告警记录**: 采用 MySQL/PostgreSQL 存储,保障数据稳定性
- **实时指标缓存**: Pulse 端采用本地缓存存储实时指标数据(留存 7 天),保障查询效率
- **数据备份**: 支持定时备份(每日凌晨全量备份,每 6 小时增量备份),备份数据留存 30 天

## 七、版本规划

### 7.1 v1.0 MVP(最小可行产品)

#### 7.1.1 核心目标
- 完成基础采集与分析能力,支撑海外节点网络监控场景落地
- 验证 Pulse Beacon 与 Pulse 协同架构的可行性

#### 7.1.2 功能清单

**Pulse Beacon**
- ✅ Linux amd64 架构支持(CentOS 9+、Ubuntu 24.04+)
- ✅ TCP/UDP 探测(适配 ICMP 禁 ping 环境)
- ✅ 核心指标采集(时延、丢包率、抖动、单程时延、时延方差)
- ✅ Prometheus Metrics 接口暴露
- ✅ 独立模式运行
- ✅ 配置热更新(YAML 格式,支持 JSON 备选)

**Pulse**
- ✅ 探测规则管理与下发(基础规则)
- ✅ 实时指标计算与健康状态判定
- ✅ 7 天性能基线生成
- ✅ 基础异常归因(区分节点本地/跨境链路问题)
- ✅ 实时仪表盘(全局视图、单节点详情)
- ✅ 基础报表生成与导出(CSV/Excel/PDF)
- ✅ 节点信息管理(增删改查、标签分组)

### 7.2 v1.1 功能增强

#### 7.2.1 核心目标
- 增强探测能力,覆盖更多探测协议
- 优化配置管理与批量操作
- 扩展跨平台支持

#### 7.2.2 新增功能

**Pulse Beacon**
- ➕ 注册模式(接入 Pulse,接收动态配置)
- ➕ 配置优先级(Pulse 下发配置 > 本地配置)
- ➕ ICMP Ping 探测(可选协议)
- ➕ MTR 探测(逐跳路由分析)
- ➕ Traceroute 探测(多协议追踪)
- ➕ Iperf3 探测(带宽性能测试)
- ➕ 业务流量抓包监控(被动监控核心业务端口)
- ➕ 跨平台部署扩展(Windows Server 2022+、Linux arm64 架构)
- ➕ 核心指标扩展(路由跳数、上行/下行带宽、TCP 建联耗时、DNS 解析时延、分片丢包率、链路丢包节点)
- ➕ 探测参数配置(数据包大小 64/128/512 字节、探测超时 1-30 秒、探测周期 1/5/10/30 分钟)

**Pulse**
- ➕ 探测规则模板管理
- ➕ 分组批量配置下发
- ➕ 配置版本管理与回滚
- ➕ 配置验证(语法与参数合法性检查)
- ➕ 批量节点导入(CSV)
- ➕ 批量启用/禁用节点
- ➕ 配置下发进度实时监控

**非功能**
- ✅ Beacon CPU 占用 ≤5%、内存占用 ≤100M

### 7.3 v1.2 安全增强

#### 7.3.1 核心目标
- 实现用户认证与授权体系
- 保障数据传输与存储安全
- 完善操作审计与追溯机制
- 提升系统安全防护能力

#### 7.3.2 新增功能

**Pulse**
- ➕ 用户认证(账号密码、短信验证码)
- ➕ 权限管理(管理员/操作员/查看员三种角色、支持自定义角色)
- ➕ 访问控制(IP 白名单、操作权限限制)
- ➕ 操作审计(操作日志留存 6 个月、变更前后对比)
- ➕ 数据传输加密(AES 加密)
- ➕ 数据存储加密(AES 加密)
- ➕ 敏感信息脱敏展示(节点 IP、负责人信息)
- ➕ 双向认证机制(Beacon 与 Pulse 通信认证)

### 7.4 v1.3 可观测性与告警

#### 7.4.1 核心目标
- 深化与 Prometheus 生态的集成
- 实现分级告警与推送能力
- 优化告警联动策略

#### 7.4.2 新增功能

**Pulse**
- ➕ 分级告警(P0/P1/P2)与邮件、Slack、企业微信、钉钉、短信推送
- ➕ 告警延迟 ≤30 秒
- ➕ 告警触发规则(阈值告警、趋势预警、告警抑制)
- ➕ Alertmanager 集成(告警推送)
- ➕ 告警标签与注解映射配置
- ➕ Pulse 自身 Metrics 暴露
- ➕ 接入状态监控(推送成功率、失败次数、平均推送延迟)
- ➕ 告警去重策略配置(时间窗口内仅推送一次)
- ➕ 告警阈值配置(自定义阈值、覆盖默认规则)
- ➕ 趋势预警配置(指标持续恶化规则)
- ➕ 告警渠道配置(按级别配置渠道)
- ➕ 差异化规则配置(按节点/分组配置)
- ➕ 告警规则模板管理
- ➕ 告警规则导入导出(YAML/JSON 格式)
- ➕ 告警记录管理(按节点/时间/级别筛选、处理状态跟踪)

**Grafana Dashboard**
- ➕ 提供 NodePulse 官方 Grafana Dashboard 模板
- ➕ 支持一键导入

**非功能**
- ✅ 告警记录留存 1 年

### 7.5 v1.4 自愈能力

#### 7.5.1 核心目标
- 实现简单故障的自动修复,降低运维压力

#### 7.5.2 新增功能

**Pulse Beacon**
- ➕ 自愈规则执行(服务重启、端口重新绑定、网络接口重置)
- ➕ 自愈前确认机制
- ➕ 自愈执行次数限制
- ➕ 自愈日志上报

**Pulse**
- ➕ 自愈规则配置管理
- ➕ 自愈规则下发
- ➕ 自愈执行状态监控
- ➕ 自愈日志汇总查询
- ➕ 自愈失败告警

### 7.6 v1.5 海外场景适配与易用性

#### 7.6.1 核心目标
- 适配主流海外运营商网络环境
- 优化跨境网络场景探测能力
- 提升部署易用性与本地化支持

#### 7.6.2 新增功能

**Pulse Beacon**
- ➕ 多视角探测对比(国内电信/联通/移动 vs 海外本地运营商)
- ➕ 数据压缩与断点续传优化
- ➕ 运营商网络环境自动识别
- ➕ 注册模式配置同步(心跳同步版本号、主动推送长连接、断连容错)
- ➕ 配置下发机制(心跳同步、主动推送)

**Pulse**
- ➕ 运营商网络数据对比分析
- ➕ 跨境链路优化建议
- ➕ 本地化适配(多时区展示、中英双语切换)
- ➕ 浏览器兼容性(Chrome/Firefox/Edge 最新版本)

**部署与文档**
- ➕ 一键安装脚本(Beacon 自动化部署)
- ➕ Docker 容器化部署(Pulse 端)
- ➕ 详细使用手册
- ➕ 常见问题解答(FAQ)

### 7.7 v1.6 数据备份与恢复

#### 7.7.1 核心目标
- 保障数据安全与可靠性
- 支持数据快速恢复与迁移

#### 7.7.2 新增功能

**Pulse**
- ➕ 定时备份(每日凌晨全量备份、每 6 小时增量备份)
- ➕ 备份数据留存 30 天
- ➕ 手动触发备份功能
- ➕ 数据恢复功能(支持全量与增量恢复)
- ➕ 备份状态监控(备份成功率、失败告警)
- ➕ 备份文件管理(查看、删除、下载)

**非功能**
- ✅ 实时指标缓存采用本地存储(留存 7 天)

### 7.8 v2.0 智能分析

#### 7.8.1 核心目标
- 引入 AI 算法,提升异常识别与归因精准度
- 优化跨境网络场景适配

#### 7.8.2 新增功能

**Pulse**
- ➕ AI 异常模式识别(运营商割接、国际出口拥堵)
- ➕ 预测性告警(指标趋势预测,提前预警)
- ➕ 路由绕路自动识别与告警
- ➕ 跨境链路拓扑图可视化

### 7.7 v1.7 业务联动

#### 7.7.1 核心目标
- 关联网络性能与业务可用性,实现根因定位闭环

#### 7.7.2 新增功能

**Pulse**
- ➕ 业务监控平台对接 API
- ➕ 业务指标与网络指标关联分析
- ➕ 根因定位报告生成
- ➕ 优化建议自动生成

### 7.8 v2.0 多云适配

#### 7.8.1 核心目标
- 兼容主流海外云厂商节点

#### 7.8.2 新增功能

**Pulse Beacon**
- ➕ AWS 节点适配(VPC 内探测、CloudWatch 指标对接)
- ➕ Azure 节点适配
- ➕ GCP 节点适配

**Pulse**
- ➕ 云平台节点自动识别与标签
- ➕ 云平台专属监控模板

### 7.9 v2.1 智能分析

#### 7.9.1 核心目标
- 引入 AI 算法,提升异常识别与归因精准度
- 优化跨境网络场景适配

#### 7.9.2 新增功能

**Pulse**
- ➕ AI 异常模式识别(运营商割接、国际出口拥堵)
- ➕ 预测性告警(指标趋势预测,提前预警)
- ➕ 路由绕路自动识别与告警

### 7.10 v2.2 集群化

#### 7.10.1 核心目标
- 支持大规模节点监控,提升系统可用性

#### 7.10.2 新增功能

**Pulse**
- ➕ 集群部署模式(支持横向扩容)
- ➕ 数据分片与负载均衡
- ➕ 高可用架构(主备切换)
- ➕ 分布式存储(时序数据库集成)
- ➕ 数据采样与聚合优化

**非功能**
- ✅ 支持 ≥1000 个海外节点同时探测
- ✅ 单节点指标计算延迟 ≤1 秒

## 八、风险与应对

| 风险类型 | 具体描述 | 应对措施 |
|---------|---------|---------|
| **环境适配风险** | 海外部分机房禁用多种探测协议,导致探测失效 | 预留多协议探测方案,支持自定义探测端口,提供探测协议自动适配功能,检测到协议不可用时自动切换 |
| **数据传输风险** | 跨境网络波动导致采集数据丢失或延迟过高 | 采用数据压缩+断点续传机制,设置数据重传策略,本地缓存临时数据,网络恢复后同步至服务端 |
| **性能风险** | 节点数量增多后,服务端处理压力过大,导致延迟升高 | 核心服务端初期采用单体部署简化运维,预留集群扩展能力;优化数据聚合算法,减少不必要的计算开销;设置数据采样机制,高并发时保障核心指标计算优先 |
| **告警风暴风险** | 海外节点集中出现异常时,产生大量告警,干扰运维判断 | 启用告警抑制与聚合功能,同一类型异常按区域/分组聚合推送;设置告警优先级,优先推送严重级别告警 |
| **安全风险** | 海外节点被攻击,导致采集端被篡改或数据泄露;Prometheus Metrics 接口被未授权访问 | 加强采集端安全校验,定期更新安全补丁;采用双向认证机制,确保采集端与服务端合法通信;敏感数据脱敏存储与展示;为 Metrics 接口配置 IP 白名单,限制仅授权 Prometheus 服务器访问 |

## 九、后续迭代方向

- **智能分析升级**: 引入 AI 算法,识别网络异常模式(如运营商割接、国际出口拥堵),提升归因精准度

- **链路可视化升级**: 绘制跨境路由拓扑图,直观展示链路绕路、故障节点位置

- **业务联动升级**: 对接业务监控平台,关联网络性能与业务可用性数据,实现根因定位闭环

- **多云适配升级**: 兼容 AWS/Azure/GCP 等海外云厂商节点,适配云平台网络监控特性

- **自愈能力升级**: 支持更复杂故障的自动修复,如链路切换、节点冗余切换

- **可观测性深化**: 新增 Prometheus 指标可视化模板(Grafana Dashboard),支持一键导入;优化 Pulse 与 Prometheus 的告警联动策略,实现跨系统告警闭环
